<br />

<%= form_for(@current_order) do |f| %>

  <% if current_order.errors.keys.include?(:email) %>
    <div class="alert-message block-message error">
      <ul>
        <li>Email <%= current_order.errors.messages.values_at(:email).flatten.first %></li>
      </ul>
    </div>
  <% elsif current_order.shipping_address.errors.any? %>
    <div class="alert-message block-message error">
      <p> Shipping address error ! </p>
      <ul>
        <% current_order.shipping_address.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% elsif current_order.billing_address.errors.any? %>
    <div class="alert-message block-message error">
      <p> Billing address error ! </p>
      <ul>
        <% current_order.billing_address.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>
  <br />

  <div>
    <%= f.label :email, 'Your email address' %>
    <%= f.text_field :email, class: 'xlarge', size: 30 %>
  </div>
  <br />


  <div>
  <div style='float:left;width:200px;'>
    <%= f.fields_for :shipping_address do |shipping_form| %>
      <h1>Shipping address</h1>
      <br />
      <%= shipping_form.label :first_name %>
      <%= shipping_form.text_field :first_name %>
      <br />

      <%= shipping_form.label :last_name %>
      <%= shipping_form.text_field :last_name %>
      <br />
      <%= shipping_form.label :address1 %>
      <%= shipping_form.text_field :address1 %>
      <br />
      <%= shipping_form.label :address2 %>
      <%= shipping_form.text_field :address2 %>
      <br />
      <%= shipping_form.label :city %>
      <%= shipping_form.text_field :city %>
      <br />
      <%= shipping_form.label :state %>
      <%= shipping_form.text_field :state %>
      <br />
      <%= shipping_form.label :zip %>
      <%= shipping_form.text_field :zip %>
      <br />
      <%= shipping_form.label :country %>
      <%= shipping_form.text_field :country %>
      <br />
      <br />
      <%= shipping_form.check_box :use_for_billing %>
      Use this address as billing address too
    <% end %>
  </div>

  <div style='float:left;width:200px;' id='billing_form'>
    <%= f.fields_for :billing_address do |billing_form| %>
      <h1>Billing address</h1>
      <br />
      <%= billing_form.label :first_name %>
      <%= billing_form.text_field :first_name %>
      <br />
      <%= billing_form.label :last_name %>
      <%= billing_form.text_field :last_name %>
      <br />
      <%= billing_form.label :address1 %>
      <%= billing_form.text_field :address1 %>
      <br />
      <%= billing_form.label :address2 %>
      <%= billing_form.text_field :address2 %>
      <br />
      <%= billing_form.label :city %>
      <%= billing_form.text_field :city %>
      <br />
      <%= billing_form.label :state %>
      <%= billing_form.text_field :state %>
      <br />
      <%= billing_form.label :zip %>
      <%= billing_form.text_field :zip %>
      <br />
      <%= billing_form.label :country %>
      <%= billing_form.text_field :country %>
    <% end %>
  </div>
  <div style='clear:both;'></div>
  <div>

  <p>
    <br />
    <%= f.submit 'Submit' %>
    <br />
  </p>
<% end %>
