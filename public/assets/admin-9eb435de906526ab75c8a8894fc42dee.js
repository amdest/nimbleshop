$(function(){$("span.fieldWithErrors").each(function(){var a=$(this);a.find("input").addClass("error"),a.closest(".clearfix").addClass("error")})}),jQuery(function(a){a("form a.add_nested_fields").live("click",function(){var b=a(this).attr("data-association"),c=a("#"+b+"_fields_blueprint").html(),d=(a(this).closest(".fields").find("input:first").attr("name")||"").replace(new RegExp("[[a-z]+]$"),"");if(d){var e=d.match(/[a-z_]+_attributes/g)||[],f=d.match(/(new_)?[0-9]+/g)||[];for(var g=0;g<e.length;g++)f[g]&&(c=c.replace(new RegExp("(_"+e[g]+")_.+?_","g"),"$1_"+f[g]+"_"),c=c.replace(new RegExp("(\\["+e[g]+"\\])\\[.+?\\]","g"),"$1["+f[g]+"]"))}var h=new RegExp("new_"+b,"g"),i=(new Date).getTime();c=c.replace(h,"new_"+i);var j=a(c).insertBefore(this);return a(this).closest("form").trigger({type:"nested:fieldAdded",field:j}),!1}),a("form a.remove_nested_fields").live("click",function(){var b=a(this).prev("input[type=hidden]")[0];return b&&(b.value="1"),a(this).closest(".fields").hide(),a(this).closest("form").trigger("nested:fieldRemoved"),!1})}),$(".submittable").live("change",function(){$(this).closest("form").submit()}),$(function(){$("input.focus:first").focus()})